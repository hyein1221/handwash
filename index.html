<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>ì†ì”»ê¸° ê²Œì„ğŸ§¼</title>
<style>
  :root {
    --line:#cddfee;
    --text:#1d2b3a;
    --p1:#79c8ff;
    --p2:#ff9ecd;
    --tile-bg:#ffffff;
    --tile-border:#cddfee;
    --special-start:#e8fff1;
    --special-goal:#fff7d9;
    --bg:#f5fbff;
    --panel-bg:#ffffff;
    --accent-blue:#13506f;
    --accent-pink:#7a1d1d;
  }

  * { box-sizing:border-box; }

  body {
    font-family: "Pretendard", system-ui, -apple-system, BlinkMacSystemFont,
      "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 16px 16px 80px;
    gap: 12px;
  }

  h1 {
    font-size: 1.1rem;
    font-weight: 600;
    text-align: center;
    margin: 0;
    line-height:1.4;
  }

  .subtitle {
    font-size: .8rem;
    text-align:center;
    color:#4e6b86;
    line-height:1.4;
  }

  .layout {
    display:flex;
    flex-direction:column;
    gap:16px;
    width:100%;
    max-width:950px;
  }
  @media(min-width:768px){
    .layout {
      flex-direction:row;
      align-items:flex-start;
    }
  }

  /* BOARD AREA */
  .board-wrapper {
    flex:1 1 auto;
    display:flex;
    justify-content:center;
  }

  .board {
    width: min(80vw,480px);
    height: min(80vw,480px);
    background:#fff;
    border: 2px solid var(--line);
    border-radius: 16px;
    box-shadow:0 20px 40px rgba(0,0,0,.05);
    position: relative;
    display:grid;
    grid-template-columns: repeat(5,1fr);
    grid-template-rows: repeat(5,1fr);
    gap:4px;
    padding:8px;
    background: radial-gradient(circle at 50% 40%, #ffffff 0%, #e9f6ff 80%);
    font-size:10px;
  }

  /* ê¸°ë³¸ íƒ€ì¼ */
  .tile {
    background:var(--tile-bg);
    border:2px solid var(--tile-border);
    border-radius:10px;
    padding:4px;
    font-size:10px;
    font-weight:600;
    line-height:1.2;
    color:#1d2b3a;
    position:relative;
    display:flex;
    justify-content:center;
    align-items:center;
    text-align:center;
  }

  /* START/GOAL ì¹¸ ê°•ì¡° */
  .start-tile {
    background:var(--special-start);
    border-color:#9fe1ad;
    color:#2f6f33;
  }
  .goal-tile {
    background:var(--special-goal);
    border-color:#ffd36a;
    color:#6a4a00;
  }

  /* ê°€ìš´ë°(ë³´ë“œ ë‚´ë¶€)ëŠ” ë¹„ì›Œë‘ê¸° */
  .empty {
    background:transparent;
    border:none;
    box-shadow:none;
    pointer-events:none;
  }

  /* ì¤‘ì•™ ë¼ë²¨: ë¡œê³  + íƒ€ì´í‹€ */
  .center-label{
    position:absolute;
    top:50%;
    left:50%;
    width:70%;
    max-width:240px;
    transform:translate(-50%,-50%);
    text-align:center;
    background:#ffffffcc;
    border:2px solid var(--line);
    border-radius:12px;
    box-shadow:0 16px 32px rgba(0,0,0,.07);
    padding:12px;
  }
  .center-logo-wrap {
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:8px;
  }
  .center-logo-wrap img {
    max-width:80px;
    height:auto;
    display:block;
  }
  .center-main-title{
    font-weight:600;
    font-size:14px;
    line-height:1.4;
    color:#1d2b3a;
  }
  .center-sub{
    font-size:10px;
    color:#4e6b86;
    line-height:1.4;
    white-space:pre-line;
  }

  /* player tokens (bigger now) */
  .player-token {
    position:absolute;
    width:28px;
    height:28px;
    border-radius:50%;
    border:3px solid #fff;
    box-shadow:0 4px 8px rgba(0,0,0,.25);
    font-size:10px;
    font-weight:700;
    color:#1d2b3a;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .p1 { background:var(--p1); }
  .p2 { background:var(--p2); }

  /* index badge on tile */
  .idx {
    position:absolute;
    top:2px;
    left:4px;
    font-size:8px;
    line-height:1;
    opacity:.4;
    font-weight:600;
  }

  .label-text {
    font-size:10px;
    font-weight:600;
    text-align:center;
    line-height:1.3;
  }

  /* SIDE PANEL */
  .panel {
    flex:0 1 280px;
    background:var(--panel-bg);
    border:2px solid var(--line);
    border-radius:16px;
    box-shadow:0 20px 40px rgba(0,0,0,.05);
    padding:16px;
    display:flex;
    flex-direction:column;
    gap:16px;
    font-size:12px;
    line-height:1.4;
  }

  .section-title {
    font-size:12px;
    font-weight:600;
    display:flex;
    align-items:center;
    gap:6px;
    color:#234;
  }

  .row {
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:8px;
  }

  /* ì£¼ì‚¬ìœ„ ì‹œê°ì˜ì—­ */
  .dice-visual {
    width:40px;
    height:40px;
    border-radius:8px;
    background:#fff;
    border:2px solid var(--line);
    position:relative;
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:0; /* hide text */
  }
  .die-face {
    width:24px;
    height:24px;
    position:relative;
  }
  .pip {
    width:6px;
    height:6px;
    background:#1d2b3a;
    border-radius:50%;
    position:absolute;
  }
  /* positions for pip dots (like a real die) */
  .pip.p1 { top:50%; left:50%; transform:translate(-50%,-50%); }
  .pip.p2a { top:4px; left:4px; }
  .pip.p2b { bottom:4px; right:4px; }
  .pip.p3a { top:4px; left:4px; }
  .pip.p3b { top:50%; left:50%; transform:translate(-50%,-50%); }
  .pip.p3c { bottom:4px; right:4px; }
  .pip.p4a { top:4px; left:4px; }
  .pip.p4b { top:4px; right:4px; }
  .pip.p4c { bottom:4px; left:4px; }
  .pip.p4d { bottom:4px; right:4px; }
  .pip.p5a { top:4px; left:4px; }
  .pip.p5b { top:4px; right:4px; }
  .pip.p5c { bottom:4px; left:4px; }
  .pip.p5d { bottom:4px; right:4px; }
  .pip.p5e { top:50%; left:50%; transform:translate(-50%,-50%); }
  .pip.p6a { top:4px; left:4px; }
  .pip.p6b { top:4px; right:4px; }
  .pip.p6c { top:50%; left:4px; transform:translateY(-50%); }
  .pip.p6d { top:50%; right:4px; transform:translateY(-50%); }
  .pip.p6e { bottom:4px; left:4px; }
  .pip.p6f { bottom:4px; right:4px; }

  /* roll animation (shake) */
  .rolling {
    animation: shake 0.4s infinite;
  }
  @keyframes shake {
    0%   { transform: rotate(0deg)   scale(1); }
    25%  { transform: rotate(10deg)  scale(1.05); }
    50%  { transform: rotate(0deg)   scale(1); }
    75%  { transform: rotate(-10deg) scale(1.05); }
    100% { transform: rotate(0deg)   scale(1); }
  }

  #rollBtn{
    background:#1d90ff;
    border:none;
    color:#fff;
    font-size:12px;
    font-weight:600;
    line-height:1;
    padding:10px 12px;
    border-radius:10px;
    box-shadow:0 8px 16px rgba(29,144,255,.3);
    cursor:pointer;
  }
  #rollBtn:disabled {
    opacity:.5;
    cursor:default;
  }
  #rollBtn:active{
    transform:translateY(1px);
    box-shadow:0 4px 8px rgba(29,144,255,.2);
  }

  .players-status{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
  }

  .player-card{
    flex:1 1 125px;
    background:#f9f9fb;
    border:2px solid var(--line);
    border-radius:12px;
    padding:10px;
    line-height:1.4;
    min-width:125px;
  }
  .player-head{
    display:flex;
    align-items:center;
    gap:6px;
    font-weight:600;
    font-size:11px;
  }
  .dot{
    width:12px;
    height:12px;
    border-radius:50%;
    border:2px solid #fff;
    box-shadow:0 2px 4px rgba(0,0,0,.2);
  }
  .dot.p1{ background:var(--p1); }
  .dot.p2{ background:var(--p2); }

  .turn-indicator{
    font-size:11px;
    color:#4e6b86;
  }

  .message-box{
    background:#fffef5;
    border:2px solid #ffe9a9;
    border-radius:12px;
    padding:12px;
    font-size:11px;
    line-height:1.4;
    min-height:70px;
  }
  .message-title{
    font-weight:600;
    margin-bottom:4px;
    color:#6a4a00;
    font-size:11px;
  }
  .message-body{
    color:#4a3a00;
    white-space:pre-line;
  }

  /* MODAL POPUP (í€´ì¦ˆ) */
  .modal-overlay{
    position:fixed;
    left:0;top:0;right:0;bottom:0;
    background:rgba(0,0,0,.4);
    display:none;
    justify-content:center;
    align-items:center;
    padding:16px;
    z-index:900;
  }
  .modal{
    background:#fff;
    border-radius:16px;
    max-width:320px;
    width:100%;
    border:2px solid var(--line);
    box-shadow:0 24px 48px rgba(0,0,0,.25);
    padding:16px;
    font-size:14px;
    line-height:1.4;
    position:relative;
    z-index:901;
  }
  .modal-title{
    font-size:14px;
    font-weight:600;
    margin-bottom:8px;
  }
  .modal-question{
    font-size:13px;
    line-height:1.5;
    margin-bottom:12px;
    white-space:pre-line;
  }
  .choices{
    display:flex;
    flex-direction:column;
    gap:8px;
    margin-bottom:12px;
  }
  .choice-btn{
    border:2px solid var(--line);
    border-radius:10px;
    padding:10px;
    background:#fff;
    font-size:13px;
    text-align:left;
    cursor:pointer;
  }
  .choice-btn.correct{
    border-color:#43c16b;
    background:#e8fff1;
    color:#1c5a2e;
    font-weight:600;
  }
  .choice-btn.wrong{
    border-color:#ff7d7d;
    background:#fff1f1;
    color:#7a1d1d;
    font-weight:600;
  }
  .modal-feedback{
    font-size:12px;
    line-height:1.4;
    min-height:32px;
    color:#4e6b86;
    white-space:pre-line;
    margin-bottom:12px;
  }
  .close-btn{
    width:100%;
    background:#1d90ff;
    color:#fff;
    border:none;
    font-size:13px;
    font-weight:600;
    line-height:1;
    padding:10px;
    border-radius:10px;
    cursor:pointer;
    text-align:center;
  }
  .close-btn:active{
    transform:translateY(1px);
    box-shadow:0 4px 8px rgba(29,144,255,.4);
  }

  /* í­ì£½ ì´í™íŠ¸ */
  .fireworks {
    position:fixed;
    left:0;top:0;right:0;bottom:0;
    pointer-events:none;
    overflow:hidden;
    z-index:950;
    display:none;
  }
 .burst {
  position:absolute;
  width:6px;
  height:6px;
  border-radius:50%;
  animation: pop 700ms ease-out forwards;
}
@keyframes pop {
  0%   { transform:translate(0,0) scale(1); opacity:1; }
  100% { transform:translate(var(--dx),var(--dy)) scale(0.2); opacity:0; }
}

  /* Footer info */
  .footer-info {
    margin-top:16px;
    font-size:11px;
    text-align:center;
    color:#4e6b86;
    line-height:1.5;
  }

</style>
</head>
<body>
<h1>ì†ì”»ê¸° ê²Œì„ğŸ§¼</h1>
<div class="subtitle">
  ì£¼ì‚¬ìœ„ë¥¼ êµ´ë ¤ ì•ìœ¼ë¡œ ì´ë™í•´ìš”.<br/>
  ë„ì°©í•œ ì¹¸ì˜ ì†ì”»ê¸° í€´ì¦ˆì— ë‹µí•´ë³¼ê¹Œìš”?
</div>

<div class="layout">
  <!-- BOARD -->
  <div class="board-wrapper">
    <div class="board" id="board">
      <!-- ì¤‘ì•™ ë¼ë²¨ -->
      <div class="center-label">
        <div class="center-logo-wrap">
          <img src="./rogo_1.png" alt="ì§ˆë³‘ê´€ë¦¬ì²­ êµ­ë¯¼ì†Œí†µë‹¨ ë¡œê³ " />
          <div class="center-main-title">ì† ì”»ê¸° ê²Œì„</div>
          <div class="center-sub">
            íë¥´ëŠ” ë¬¼ì— ë¹„ëˆ„ë¡œ 30ì´ˆ ğŸ§¼
            ì†ë°”ë‹¥ â†’ ì†ë“± â†’ ì†ê°€ë½ ì‚¬ì´ </br>  â†’ ì†í†± ë°‘ â†’ ì—„ì§€ â†’ ì†ëª©
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SIDE PANEL -->
  <div class="panel">
    <div class="section-title">ğŸ² ì£¼ì‚¬ìœ„ & ì§„í–‰</div>

    <div class="row" style="align-items:flex-start;">
      <div>ì£¼ì‚¬ìœ„:</div>
      <div class="dice-visual" id="diceBox">
        <div class="die-face" id="dieFace"></div>
      </div>
      <button id="rollBtn">ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</button>
    </div>

    <div class="row">
      <div>í˜„ì¬ ì°¨ë¡€:</div>
      <div class="dice-visual" style="width:48px;height:32px;">
        <div style="font-size:14px;font-weight:600;color:#1d2b3a;" id="currentPlayerBox">P1</div>
      </div>
    </div>

    <div class="players-status">
      <div class="player-card">
        <div class="player-head">
          <div class="dot p1"></div>
          <div>P1 (íŒŒë‘)</div>
        </div>
        <div class="turn-indicator">ìœ„ì¹˜: <span id="p1PosText">0</span> ì¹¸</div>
      </div>

      <div class="player-card">
        <div class="player-head">
          <div class="dot p2"></div>
          <div>P2 (í•‘í¬)</div>
        </div>
        <div class="turn-indicator">ìœ„ì¹˜: <span id="p2PosText">0</span> ì¹¸</div>
      </div>
    </div>

    <div class="section-title">ğŸ“¢ í˜„ì¬ ì¹¸</div>
    <div class="message-box">
      <div class="message-title" id="messageTitle">ê²Œì„ ì‹œì‘</div>
      <div class="message-body" id="messageBody">
        START ì¹¸ì…ë‹ˆë‹¤.
        ì£¼ì‚¬ìœ„ë¥¼ ëˆŒëŸ¬ ì´ë™í•´ìš”!
      </div>
    </div>
  </div>
</div>

<div class="footer-info">
  ì œì‘ì: ì§ˆë³‘ê´€ë¦¬ì²­ êµ­ë¯¼ì†Œí†µë‹¨ 9ê¸° ê¹€í˜œì¸<br/>
  ë¬¸ì˜: hyein_1221@hanmail.net
</div>

<!-- MODAL: í€´ì¦ˆ íŒì—… -->
<div class="modal-overlay" id="quizModal">
  <div class="modal">
    <div class="modal-title" id="quizTitle">í€´ì¦ˆ ì œëª©</div>
    <div class="modal-question" id="quizQuestion">ì§ˆë¬¸ ë‚´ìš©</div>
    <div class="choices" id="choicesContainer"></div>
    <div class="modal-feedback" id="quizFeedback"></div>
    <button class="close-btn" id="closeQuizBtn">ë‹«ê¸°</button>
  </div>
</div>

<!-- í­ì£½ -->
<div class="fireworks" id="fireworks"></div>

<!-- ì´ë™ íš¨ê³¼ìŒ (ì§§ì€ í´ë¦­ ì‚¬ìš´ë“œ base64) -->
<audio id="stepSound">
  <source src="data:audio/mp3;base64,//uQxAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQCA//////////////////////////////8AAAAALGF2YQAAAA8AAAACAAACcQCA//////////////////////////////8AAAAA" type="audio/mp3">
</audio>

<script>
/* ======================================================
   ê²½ë¡œ ì •ì˜ (ë³´ë“œ í…Œë‘ë¦¬ í•œ ë°”í€´)
   ======================================================

5x5 ê·¸ë¦¬ë“œì˜ ì¸ë±ìŠ¤: row*5 + col
ìš°ë¦¬ëŠ” ì˜¤ë¥¸ìª½ ì•„ë˜ ëª¨ì„œë¦¬(4,4)ì—ì„œ ì¶œë°œí•´ì„œ
ì‹œê³„ë°©í–¥ìœ¼ë¡œ í•œ ë°”í€´ ë„ëŠ” ëŠë‚Œ ëŒ€ì‹ ,
ìš°ë¦¬ê°€ ì •ì˜í•œ ìˆœì„œëŒ€ë¡œë§Œ ì´ë™í•˜ë©´ ë¼.

pathOrder[0] = START ìœ„ì¹˜ gridIndex(4,4)=24
...
ë§ˆì§€ë§‰ pathOrder[15] = gridIndex(3,4)=19
ê·¸ ë‹¤ìŒ ë‹¤ì‹œ START(24)ë¡œ ì˜¤ë©´ GOAL ì²˜ë¦¬.
*/
const pathOrder = [
  24,23,22,21,20,15,10,5,0,1,2,3,4,9,14,19
];
// ì´ 16ì¹¸. í•œ ë°”í€´ ëŒê³  ë‹¤ì‹œ 24ë¡œ ëŒì•„ì˜¤ë©´ ì™„ì£¼.

const tilesData = [
  {
    label:"START",
    start:true,
    quiz:{
      title:"ì‹œì‘!",
      question:"ê¹¨ë—í•œ ì†ìœ¼ë¡œ ê±´ê°• ì§€í‚¤ê¸° ëª¨í—˜ì„ ì‹œì‘í•´ìš”!",
      type:"info",
      choices:[],
      answerIndex:null,
      feedback:"ì£¼ì‚¬ìœ„ë¥¼ êµ´ë ¤ ì•ìœ¼ë¡œ ê°€ìš”!"
    }
  },
  {
    label:"ì†ì€ ì–¸ì œ ì”»ì§€?",
    quiz:{
      title:"ì–¸ì œ ì†ì„ ì”»ì–´ì•¼ í• ê¹Œìš”?",
      question:"ë‹¤ìŒ ì¤‘ ì†ì„ ê¼­ ì”»ì–´ì•¼ í•˜ëŠ” ë•ŒëŠ”?\n1) ë°¥ ë¨¹ê¸° ì „\n2) ì¶¤ì¶”ê¸° ì „",
      type:"mcq",
      choices:["ë°¥ ë¨¹ê¸° ì „","ì¥ë‚œê° ë³´ê¸° ì „"],
      answerIndex:0,
      feedback:"ì‹ì‚¬ë‚˜ ê°„ì‹ ì „ì—ëŠ” ì†ì„ ê¹¨ë—í•˜ê²Œ ì”»ì–´ìš” ğŸ½"
    }
  },
  {
    label:"í™”ì¥ì‹¤ ë‹¤ë…€ì˜¨ í›„ì—ëŠ”?",
    quiz:{
      title:"í™”ì¥ì‹¤ ë‹¤ë…€ì˜¨ í›„ì—ëŠ”?",
      question:"í™”ì¥ì‹¤ ë‹¤ë…€ì˜¨ ë’¤ì—ëŠ” ì†ì„ ì”»ì§€ ì•Šì•„ë„ ëœë‹¤.",
      type:"ox",
      choices:["O (ë§ì•„ìš”)","X (ì•„ë‹ˆì—ìš”)"],
      answerIndex:1,
      feedback:"í™”ì¥ì‹¤ ë‹¤ë…€ì˜¨ í›„ì—ëŠ” ê¼­ ë¹„ëˆ„ë¡œ 30ì´ˆ ì†ì”»ê¸°! ğŸš½ğŸ§¼"
    }
  },
  {
    label:"ë¹„ëˆ„ê°€ ì™œ í•„ìš”í• ê¹Œ?",
    quiz:{
      title:"ë¹„ëˆ„ê°€ ì™œ í•„ìš”í• ê¹Œ?",
      question:"ì„¸ê· ì„ ì˜ ì—†ì• ì£¼ëŠ” ê²ƒì€?\n1) ë¹„ëˆ„ì™€ ë¬¼\n2) ë°”ëŒ ì¬ê¸°",
      type:"mcq",
      choices:["ë¹„ëˆ„ì™€ ë¬¼","ë°”ëŒ ì¬ê¸°"],
      answerIndex:0,
      feedback:"íë¥´ëŠ” ë¬¼ + ë¹„ëˆ„ë¡œ ë¬¸ì§ˆë¬¸ì§ˆ í•´ì•¼ ì„¸ê· ì´ ì˜ ë–¨ì–´ì ¸ìš” ğŸ§¼ğŸ’¦"
    }
  },
  {
    label:"ê¸°ì¹¨ í›„ì—ëŠ”?",
    quiz:{
      title:"ê¸°ì¹¨ í›„ì—ëŠ”?",
      question:"ë‚´ê°€ ì†ìœ¼ë¡œ ì…ì„ ê°€ë¦¬ê³  ê¸°ì¹¨í–ˆì–´ìš”.\nê·¸ ë‹¤ìŒ í•´ì•¼ í•  ì¼ì€?",
      type:"mcq",
      choices:["ì†ì”»ê¸°","ì•„ë¬´ ê²ƒë„ ì•ˆ í•˜ê¸°"],
      answerIndex:0,
      feedback:"ê¸°ì¹¨Â·ì½§ë¬¼ ë’¤ì—” ì†ì”»ê¸°ë¡œ ê°ì—¼ë³‘ì„ ë§‰ì•„ìš” ğŸ¤§â¡ğŸ§¼"
    }
  },
  {
    label:"ì½§ë¬¼ ë‹¦ì€ í›„ì—ëŠ”?",
    quiz:{
      title:"ì½§ë¬¼ ë‹¦ì€ í›„ì—ëŠ”?",
      question:"ì½§ë¬¼ì„ ë‹¦ì•˜ì„ ë•?\n1) ê·¸ëƒ¥ ë†€ì´ ê³„ì†í•˜ê¸°\n2) ì†ì„ ì”»ê¸°",
      type:"mcq",
      choices:["ê·¸ëƒ¥ ë†€ì´ ê³„ì†í•˜ê¸°","ì†ì„ ì”»ê¸°"],
      answerIndex:1,
      feedback:"ì½§ë¬¼ ë‹¦ì€ ë’¤ì—” ì†ì„ ê¹¨ë—í•˜ê²Œ ì”»ì–´ì•¼ í•´ìš” ğŸ‘ƒğŸ§¼"
    }
  },
  {
    label:"ë°”ê¹¥ë†€ì´ í›„ì—ëŠ”?",
    quiz:{
      title:"ë°”ê¹¥ë†€ì´ í›„ì—ëŠ”?",
      question:"ë°”ê¹¥ë†€ì´ í›„ì—ëŠ”?\nO) ì†ì”»ê¸°\nX) ê·¸ëƒ¥ ê°„ì‹ ë¨¹ê¸°",
      type:"ox",
      choices:["O ì†ì”»ê¸°","X ê·¸ëƒ¥ ë¨¹ê¸°"],
      answerIndex:0,
      feedback:"ë°”ê¹¥ë†€ì´ í›„ì—” ì†ì„ ì”»ê³  ëˆˆÂ·ì…ì„ ë§Œì§€ì§€ ì•Šì•„ìš” ğŸ›"
    }
  },
  {
    label:"ë™ë¬¼ì„ ë§Œì§„ í›„ì—ëŠ”?",
    quiz:{
      title:"ê°•ì•„ì§€ ì“°ë‹´ì“°ë‹´ğŸ¶",
      question:"ê°•ì•„ì§€/ê³ ì–‘ì´ ë§Œì§„ ë’¤, ë°”ë¡œ ìŒì‹ì„ ë¨¹ì–´ë„ ë ê¹Œ?",
      type:"mcq",
      choices:["ì‘ ê´œì°®ì•„","ì•„ë‹ˆ, ì†ì”»ê³  ë¨¹ì–´ì•¼ í•´"],
      answerIndex:1,
      feedback:"ë™ë¬¼ ë§Œì§„ ë’¤ì—” ê¼­ ì†ì„ ì”»ê³  ìŒì‹ì„ ë§Œì ¸ìš” ğŸ¶ğŸ§¼"
    }
  },
  {
    label:"ì–´ë–»ê²Œ ì†ì„ ì”»ì§€?",
    quiz:{
      title:"ì–´ë””ê¹Œì§€ ì”»ì–´?",
      question:"ì†ë°”ë‹¥ë§Œ ì‚´ì§ ì”»ìœ¼ë©´ ë ê¹Œ?\nì•„ë‹ˆë©´ ì†ê°€ë½ ì‚¬ì´ê¹Œì§€ ê¾¹ê¾¹ ì”»ì–´ì•¼ í• ê¹Œ?",
      type:"mcq",
      choices:["ì†ë°”ë‹¥ë§Œ","ì†ê°€ë½ ì‚¬ì´ê¹Œì§€"],
      answerIndex:1,
      feedback:"ì†ê°€ë½ ì‚¬ì´, ì†í†± ë°‘ê¹Œì§€ â€˜ë¬¸ì§ˆë¬¸ì§ˆâ€™ í•´ì•¼ ê¹¨ë—í•´ìš” âœ¨"
    }
  },
  {
    label:"ì†ì„ ì–¼ë§ˆë‚˜ ì”»ì–´ì•¼í• ê¹Œ?",
    quiz:{
      title:"ì–¼ë§ˆë‚˜ ì”»ì„ê¹Œ?",
      question:"ì†ì”»ê¸°ëŠ” ëª‡ ì´ˆ ë™ì•ˆ í•˜ëŠ” ê²Œ ì¢‹ì„ê¹Œìš”?\n1) 3ì´ˆ\n2) 30ì´ˆ",
      type:"mcq",
      choices:["3ì´ˆ","30ì´ˆ"],
      answerIndex:1,
      feedback:"ë¹„ëˆ„ë¡œ 30ì´ˆ ë™ì•ˆ ì²œì²œíˆ ë¬¸ì§ˆëŸ¬ìš”. íƒ€ì´ë¨¸ 'ë ë§'ê¹Œì§€! â±"
    }
  },
  {
    label:"ë¹„ëˆ„ ê±°í’ˆ",
    quiz:{
      title:"ê±°í’ˆì˜ í˜",
      question:"ë¹„ëˆ„ ê±°í’ˆì€ ì„¸ê· ì„ ë–¼ì–´ë‚´ëŠ” ë° ë„ì›€ì„ ì¤„ê¹Œìš”?",
      type:"ox",
      choices:["O ë„ì›€ì´ ë¼ìš”","X ì „í˜€ í•„ìš”ì—†ì–´ìš”"],
      answerIndex:0,
      feedback:"ê±°í’ˆì´ ì„¸ê· ì„ ë–¼ì–´ë‚´ê³  ë¬¼ì´ ì”»ì–´ë‚´ìš” ğŸ«§"
    }
  },
  {
    label:"ì–´ë””ê¹Œì§€ ì”»ì–´ì•¼í• ê¹Œ?",
    quiz:{
      title:"ì† ì–´ë””ê¹Œì§€ ì”»ì–´ìš”?",
      question:"ì†ê°€ë½ë§Œ ì”»ìœ¼ë©´ ë ê¹Œìš”?\nì•„ë‹ˆë©´ ì†ëª©ê¹Œì§€ ì”»ì–´ì•¼ í• ê¹Œìš”?",
      type:"mcq",
      choices:["ì†ê°€ë½ë§Œ","ì†ëª©ê¹Œì§€ ì‹¹ì‹¹"],
      answerIndex:1,
      feedback:"ì†ëª©ê¹Œì§€ ëŒë ¤ ì”»ì–´ì£¼ë©´ ë” ê¹¨ë—í•´ìš” ğŸ’ªğŸ§¼"
    }
  },
  {
    label:"ì¹œêµ¬ì™€ í•¨ê»˜í•´ìš”",
    quiz:{
      title:"ì¹œêµ¬ì™€ ì•½ì†",
      question:"ì¹œêµ¬ì—ê²Œ 'ë°¥ ë¨¹ê¸° ì „ì—” ì† ì”»ì!'ë¼ê³  ë§í•´ì£¼ëŠ” ê±´ ì¢‹ì€ ê±¸ê¹Œ?",
      type:"ox",
      choices:["O ì¢‹ì€ í–‰ë™","X ë‚˜ìœ í–‰ë™"],
      answerIndex:0,
      feedback:"í•¨ê»˜ ì•Œë ¤ì£¼ë©´ ì¹œêµ¬ë„ ê±´ê°•í•´ì ¸ìš” ğŸ‘«"
    }
  },
  {
    label:"ëˆˆì„ ë¹„ë¹„ë©´?",
    quiz:{
      title:"ëˆˆì„ ë¹„ë¹„ë©´?",
      question:"ë†€ì´í„°ì—ì„œ ë†€ê³  ê·¸ëŒ€ë¡œ ëˆˆì„ ë¹„ë¹„ë©´ ì–´ë–»ê²Œ ë ê¹Œ?",
      type:"mcq",
      choices:["ì„¸ê· ì´ ë“¤ì–´ê°ˆ ìˆ˜ ìˆì–´ìš”","ì•„ë¬´ ì¼ë„ ì•ˆ ìƒê²¨ìš”"],
      answerIndex:0,
      feedback:"ë”ëŸ¬ìš´ ì†ì´ ëˆˆÂ·ì½”Â·ì…ì— ë‹¿ìœ¼ë©´ ì„¸ê· ì´ ëª¸ì†ìœ¼ë¡œ ë“¤ì–´ê°ˆ ìˆ˜ ìˆì–´ìš” ğŸ‘€"
    }
  },
  {
    label:"ì†ì„ ì”»ì€ í›„ì—ëŠ”?",
    quiz:{
      title:"ì† ë‹¦ì„ ë•Œ",
      question:"ì†ì„ ë‹¤ ì”»ì€ ë‹¤ìŒì—ëŠ”?\n1) ë°”ì§€ì— ìŠ¥ìŠ¥\n2) ê°œì¸ìˆ˜ê±´/ì¼íšŒìš© íƒ€ì›”ë¡œ ê¾¹ê¾¹",
      type:"mcq",
      choices:["ë°”ì§€ì— ìŠ¥ìŠ¥","ê°œì¸ìˆ˜ê±´/ì¼íšŒìš© íƒ€ì›”"],
      answerIndex:1,
      feedback:"ê¹¨ë—í•œ ìˆ˜ê±´ìœ¼ë¡œ ê¾¹ê¾¹ ë‹¦ì•„ìš” ğŸ§»"
    }
  },
  {
    label:"ì¡°ê¸ˆë§Œ ë” í˜ë‚´!",
    quiz:{
      title:"GOAL ì§ì „!",
      question:"ì¡°ê¸ˆë§Œ ë” ê°€ë©´ ê¹¨ë—ì† ì±”í”¼ì–¸!\nì¤€ë¹„ëë‚˜ìš”?",
      type:"info",
      choices:[],
      answerIndex:null,
      feedback:"ë§ˆì§€ë§‰ í•œ ì¹¸ë§Œ ë” ê°€ìš”!"
    }
  }
];

const finalPopup = {
  title:"ì¶•í•˜í•´ìš”! ì†ì”»ê¸° ì±”í”¼ì–¸ ğŸ‰",
  question:
    "ì†ì”»ê¸° 6ë‹¨ê³„ ê¸°ì–µí•´ë³¼ê¹Œìš”?\n\n" +
    "1. ì†ë°”ë‹¥ ë¬¸ì§ˆë¬¸ì§ˆ\n" +
    "2. ì†ë“±ë„ ì“±ì“±\n" +
    "3. ì†ê°€ë½ ì‚¬ì´ ì‚¬ì´ ê¼¼ê¼¼í•˜ê²Œ\n" +
    "4. ì†í†± ë°‘ ê¾¹ê¾¹ ë¬¸ì§€ë¥´ê¸°\n" +
    "5. ì—„ì§€ì†ê°€ë½ ë¹™ê¸€ë¹™ê¸€\n" +
    "6. ì†ëª©ê¹Œì§€ ì‹¹ì‹¹\n\n" +
    "íë¥´ëŠ” ë¬¼ì— ë¹„ëˆ„ë¡œ 30ì´ˆ!" +
    "10ì›” 15ì¼ ì„¸ê³„ ì†ì”»ê¸°ì˜ ë‚  ê¸°ì–µí•´ì¤˜!" ,
  type:"info",
  choices:[],
  answerIndex:null,
  feedback:"ì¹œêµ¬ì™€ í•¨ê»˜ë¼ì„œ ë”ìš± ê¹¨ë—í•˜ê³  ì•ˆì „í•´ì¡Œì–´!ğŸ§¼ğŸ’–"
};

/* ======================================================
   ë³´ë“œ DOM ë§Œë“¤ê¸°
   ====================================================== */
const boardEl = document.getElementById("board");

// 25ì¹¸(5x5) ê¸°ë³¸ emptyë¡œ ê¹”ê³ 
for(let cell=0; cell<25; cell++){
  const d=document.createElement("div");
  d.classList.add("tile","empty");
  d.dataset.gridIndex = cell; // 0~24
  boardEl.appendChild(d);
}

// pathOrderì— ì‹¤ì œ ì¹¸ ì±„ìš°ê¸° + START/GOAL ìŠ¤íƒ€ì¼
for(let step=0; step<pathOrder.length; step++){
  const gridIdx = pathOrder[step];
  const tileEl = boardEl.querySelector(`[data-grid-index="${gridIdx}"]`);
  tileEl.classList.remove("empty");
  if(step===0){
    tileEl.classList.add("start-tile");
  }
  if(step===pathOrder.length-1){
    tileEl.classList.add("goal-tile");
  }
  const idxDiv=document.createElement("div");
  idxDiv.classList.add("idx");
  idxDiv.textContent = step;
  tileEl.appendChild(idxDiv);

  const labelDiv=document.createElement("div");
  labelDiv.classList.add("label-text");
  labelDiv.textContent = tilesData[step].label;
  tileEl.appendChild(labelDiv);
}

/* ======================================================
   ê²Œì„ ìƒíƒœ
   ====================================================== */
let currentPlayer = 1; // 1 or 2
let pos = {1:0, 2:0};  // path index ìœ„ì¹˜ (0~15)
let finished = {1:false, 2:false};
let gameOver = false;
let rolling = false;

const dieFaceEl = document.getElementById("dieFace");
const rollBtn = document.getElementById("rollBtn");
const currentPlayerBox = document.getElementById("currentPlayerBox");

const p1PosText = document.getElementById("p1PosText");
const p2PosText = document.getElementById("p2PosText");

const messageTitle = document.getElementById("messageTitle");
const messageBody = document.getElementById("messageBody");

const quizModal = document.getElementById("quizModal");
const quizTitle = document.getElementById("quizTitle");
const quizQuestion = document.getElementById("quizQuestion");
const quizFeedback = document.getElementById("quizFeedback");
const choicesContainer = document.getElementById("choicesContainer");
const closeQuizBtn = document.getElementById("closeQuizBtn");

const fireworksEl = document.getElementById("fireworks");
const stepSound = document.getElementById("stepSound");

/* ======================================================
   ì£¼ì‚¬ìœ„ ê·¸ë¦¬ê¸°
   ====================================================== */
function renderDieFace(n){
  // n:1~6
  // dieFaceEl ì•ˆì— pip DOM ë‹¤ì‹œ ë„£ê¸°
  dieFaceEl.innerHTML = "";
  const face = document.createElement("div");
  face.className = "die-face";
  if(n===1){
    face.innerHTML = `<div class="pip p1"></div>`;
  }else if(n===2){
    face.innerHTML = `<div class="pip p2a"></div><div class="pip p2b"></div>`;
  }else if(n===3){
    face.innerHTML = `<div class="pip p3a"></div><div class="pip p3b"></div><div class="pip p3c"></div>`;
  }else if(n===4){
    face.innerHTML = `<div class="pip p4a"></div><div class="pip p4b"></div><div class="pip p4c"></div><div class="pip p4d"></div>`;
  }else if(n===5){
    face.innerHTML = `<div class="pip p5a"></div><div class="pip p5b"></div><div class="pip p5c"></div><div class="pip p5d"></div><div class="pip p5e"></div>`;
  }else if(n===6){
    face.innerHTML = `<div class="pip p6a"></div><div class="pip p6b"></div><div class="pip p6c"></div><div class="pip p6d"></div><div class="pip p6e"></div><div class="pip p6f"></div>`;
  }
  dieFaceEl.appendChild(face);
}

/* ======================================================
   í”Œë ˆì´ì–´ ë§ ë Œë”ë§
   ====================================================== */
function renderPlayers(){
  // ê¸°ì¡´ í† í° ì œê±°
  document.querySelectorAll(".player-token").forEach(n=>n.remove());

  [1,2].forEach(p=>{
    const pathIdx = pos[p];
    const gridIdx = pathOrder[pathIdx];
    const tileEl = boardEl.querySelector(`[data-grid-index="${gridIdx}"]`);
    if(!tileEl) return;
    const token=document.createElement("div");
    token.classList.add("player-token", p===1?"p1":"p2");

    if(p===1){
      token.style.bottom="4px";
      token.style.left="4px";
      token.textContent="1";
    } else {
      token.style.top="4px";
      token.style.right="4px";
      token.textContent="2";
    }

    tileEl.appendChild(token);
  });

  p1PosText.textContent = pos[1];
  p2PosText.textContent = pos[2];
  currentPlayerBox.textContent = currentPlayer===1?"P1":"P2";
}

/* ======================================================
   í­ì£½ ì´í™íŠ¸
   ====================================================== */
function makeFireworkBurst(x, y) {
  // ë” í¬ê²Œ íŒ¡! í„°ëœ¨ë¦¬ê¸°
  const particleCount = 28; // ê¸°ì¡´ 12 â†’ 28
  for (let i = 0; i < particleCount; i++) {
    const dot = document.createElement("div");
    dot.className = "burst";

    // ì¡°ê°(ì»¨í˜í‹°) ì¡°ê¸ˆ ë” í¬ê²Œ
    dot.style.width = "10px";
    dot.style.height = "10px";
    dot.style.borderRadius = "3px"; // ì‚´ì§ ë„¤ëª¨ ëŠë‚Œ ì£¼ë©´ ì§„ì§œ ì»¨í˜í‹° ê°™ì´ ë³´ì—¬

    // ê°ë„ ëœë¤
    const angle = Math.random() * Math.PI * 2;

    // í›¨ì”¬ ë©€ë¦¬ ë‚ ì•„ê°€ê²Œ (ì›ë˜ 60~90px ì •ë„ì˜€ìŒ)
    const dist = 120 + Math.random() * 80; // 120~200px

    const dx = Math.cos(angle) * dist;
    const dy = Math.sin(angle) * dist;

    dot.style.left = x + "px";
    dot.style.top = y + "px";
    dot.style.setProperty("--dx", dx + "px");
    dot.style.setProperty("--dy", dy + "px");

    // ìƒ‰ ë” íŠ€ê²Œ (HSL â†’ ë†’ì€ ì±„ë„)
    dot.style.background = `hsl(${Math.floor(Math.random()*360)},90%,60%)`;

    fireworksEl.appendChild(dot);

    // ìë™ ì œê±°
    setTimeout(() => dot.remove(), 800);
  }
}

function firework() {
  fireworksEl.style.display = "block";
  const { innerWidth: w, innerHeight: h } = window;

  // ê°€ìš´ë° + ì–‘ì˜† + ìœ„ìª½ë„ íŒ¡íŒ¡
  makeFireworkBurst(w * 0.5, h * 0.3);
  makeFireworkBurst(w * 0.3, h * 0.35);
  makeFireworkBurst(w * 0.7, h * 0.35);
  makeFireworkBurst(w * 0.4, h * 0.2);
  makeFireworkBurst(w * 0.6, h * 0.2);

  // í™”ë©´ì„ ì•½ê°„ ë” ì˜¤ë˜ ìœ ì§€í•´ì„œ ì• ë“¤ì´ í™•ì¸í•  ì‹œê°„ ì£¼ê¸°
  setTimeout(() => {
    fireworksEl.style.display = "none";
  }, 1000);
}


/* ======================================================
   í€´ì¦ˆ ëª¨ë‹¬
   ====================================================== */
function openQuizModal(quiz, celebrate){
  quizModal.style.display="flex";
  quizTitle.textContent = quiz.title;
  quizQuestion.textContent = quiz.question;
  quizFeedback.textContent = "";
  choicesContainer.innerHTML = "";

  // ì¶•í•˜ í”Œë˜ê·¸(ì •ë‹µ ë§ìœ¼ë©´ í­ì£½) ì´ˆê¸°í™”
  let answered = false;

  if(quiz.type==="info"){
    closeQuizBtn.textContent="í™•ì¸";
  }else{
    closeQuizBtn.textContent="ë‹«ê¸°";
  }

  quiz.choices.forEach((choiceText, idx)=>{
    const btn=document.createElement("button");
    btn.classList.add("choice-btn");
    btn.textContent = choiceText;

    btn.addEventListener("click",()=>{
      if(answered) return;
      answered=true;
      const correct = (idx===quiz.answerIndex);
      if(correct){
        btn.classList.add("correct");
        quizFeedback.textContent = quiz.feedback || "ì •ë‹µ!";
        // ì¶•í•˜ í­ì£½
        firework();
      }else{
        btn.classList.add("wrong");
        quizFeedback.textContent = "ë‹¤ì‹œ ìƒê°í•´ë³¼ê¹Œ?\n" + (quiz.feedback||"");
      }
    });

    choicesContainer.appendChild(btn);
  });

  // info íƒ€ì…ì¼ ê²½ìš°ì—ë„ ì™„ì£¼ë‚˜ íŠ¹ë³„ ìƒí™©ì—ëŠ” í­ì£½ ê°€ëŠ¥
  if(quiz.type==="info" && celebrate){
    firework();
  }
}

function openFinalModal(){
  quizModal.style.display="flex";
  quizTitle.textContent = finalPopup.title;
  quizQuestion.textContent = finalPopup.question;
  quizFeedback.textContent = finalPopup.feedback;
  choicesContainer.innerHTML = "";
  closeQuizBtn.textContent="ì™„ë£Œ";
  firework();
}

/* ë‹«ê¸° ë²„íŠ¼ */
closeQuizBtn.addEventListener("click",()=>{
  quizModal.style.display="none";
});

/* ì¹¸ ë„ì°© í›„ ì²˜ë¦¬ */
function arriveTile(player){
  const step = pos[player];
  const tileInfo = tilesData[step];

  // ì‚¬ì´ë“œ íŒ¨ë„ ë©”ì‹œì§€ ê°±ì‹ 
  messageTitle.textContent = tileInfo.label;
  messageBody.textContent = tileInfo.quiz.feedback || tileInfo.quiz.question || "";

  // í€´ì¦ˆ ëª¨ë‹¬ ë„ìš°ê¸°
  openQuizModal(tileInfo.quiz, false);
}

/* ======================================================
   ì´ë™ ì• ë‹ˆë©”ì´ì…˜ (í•œ ì¹¸ì”© ë”±ë”±ë”± ì´ë™)
   ====================================================== */
function animateMove(player, steps, onDone){
  // stepsë§Œí¼ 1ì¹¸ì”© ì´ë™
  // ë§ˆì§€ë§‰ ë„ì°© í›„ arriveTile í˜¸ì¶œ
  if(steps<=0){
    // ì•„ë¬´ ì´ë™ë„ ì—†ìœ¼ë©´ ê·¸ëƒ¥ ë„ì°© ì²˜ë¦¬
    arriveTile(player);
    if(onDone) onDone();
    return;
  }

  let moved = 0;

  function stepOnce(){
    if(moved>=steps){
      // ë‹¤ ì´ë™ ë!
      // ë„ì°©í•œ ì¹¸ í™•ì¸
      arriveTile(player);
      if(onDone) onDone();
      return;
    }

    // ë‹¤ìŒ ì¹¸ìœ¼ë¡œ ì‹¤ì œ 1ì¹¸ ì´ë™
    pos[player]++;

    // path ë§ˆì§€ë§‰ì„ ë„˜ëŠ” ê²½ìš° -> í•œ ë°”í€´ ëŒê³  ë‹¤ì‹œ START(=finish)
    if(pos[player] > pathOrder.length-1){
      pos[player] = 0;
      finished[player]=true;
      renderPlayers();
      openFinalModal(); // ì†ì”»ê¸° 6ë‹¨ê³„ ì•ˆë‚´ + í­ì£½
      if(onDone) onDone();
      return;
    }

    renderPlayers();
    // ì´ë™ë§ˆë‹¤ íš¨ê³¼ìŒ
    try {
      stepSound.currentTime = 0;
      stepSound.play().catch(()=>{});
    } catch(e){}

    moved++;
    setTimeout(stepOnce, 250); // í•œ ì¹¸ ì´ë™ í…œí¬
  }

  stepOnce();
}

/* ======================================================
   ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸° ì• ë‹ˆë©”ì´ì…˜ + ì´ë™ ì²˜ë¦¬
   ====================================================== */
function rollDiceAndMove(){
  if(gameOver || rolling) return;
  rolling = true;
  rollBtn.disabled = true;

  // êµ´ë¦¬ëŠ” ë™ì•ˆ ëœë¤ ìˆ«ì í”ë“¤ê¸°
  const startTime = Date.now();
  const rollDuration = 1000; // 1ì´ˆ ì •ë„ êµ´ë¦¬ëŠ” ëŠë‚Œ
  const diceBox = document.getElementById("diceBox");
  diceBox.classList.add("rolling");

  function animFrame(){
    const elapsed = Date.now()-startTime;
    const tempVal = Math.floor(Math.random()*6)+1;
    renderDieFace(tempVal);

    if(elapsed < rollDuration){
      requestAnimationFrame(animFrame);
    }else{
      // ìµœì¢… ê°’ í™•ì •
      const finalVal = Math.floor(Math.random()*6)+1;
      renderDieFace(finalVal);
      diceBox.classList.remove("rolling");

      // ì´ì œ ì´ë™ ì• ë‹ˆë©”ì´ì…˜
      const thisPlayer = currentPlayer;
      animateMove(thisPlayer, finalVal, ()=>{
        // ì´ë™ í›„ í„´ ë„˜ê¸°ê¸° / ê²Œì„ì¢…ë£Œ í™•ì¸
        if(finished[1] && finished[2]){
          gameOver=true;
        }
        // í„´ ë³€ê²½
        currentPlayer = (currentPlayer===1)?2:1;
        renderPlayers();
        rollBtn.disabled = false;
        rolling = false;
      });
    }
  }
  animFrame();
}

/* ======================================================
   ì´ˆê¸° ìƒíƒœ ì„¸íŒ…
   ====================================================== */
renderDieFace(1);
renderPlayers();
// STARTì¹¸ ì•ˆë‚´ë¥¼ ì²« í™”ë©´ì— ë°”ë¡œ ë³´ì—¬ì£¼ê³  ì‹¶ìœ¼ë©´:
(function initMessage(){
  const step = pos[1]; // p1 í˜„ì¬ step (0)
  const tileInfo = tilesData[step];
  messageTitle.textContent = tileInfo.label;
  messageBody.textContent = tileInfo.quiz.feedback || tileInfo.quiz.question || "";
})();

/* ë²„íŠ¼ ì´ë²¤íŠ¸ */
rollBtn.addEventListener("click", rollDiceAndMove);

</script>
</body>
</html>

