<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>ê¹¨ë—ì† ë¶€ë£¨ë§ˆë¸” ğŸ§¼</title>
<style>
  :root {
    --line:#cddfee;
    --text:#1d2b3a;
    --p1:#79c8ff;
    --p2:#ff9ecd;
    --tile-bg:#ffffff;
    --tile-border:#cddfee;
    --special-start:#e8fff1;
    --special-goal:#fff7d9;
    --bg:#f5fbff;
    --panel-bg:#ffffff;
  }

  * { box-sizing:border-box; }

  body {
    font-family: "Pretendard", system-ui, -apple-system, BlinkMacSystemFont,
      "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 16px;
    gap: 12px;
  }

  h1 {
    font-size: 1.1rem;
    font-weight: 600;
    text-align: center;
    margin: 0;
    line-height:1.4;
  }

  .subtitle {
    font-size: .8rem;
    text-align:center;
    color:#4e6b86;
    line-height:1.4;
  }

  .layout {
    display:flex;
    flex-direction:column;
    gap:16px;
    width:100%;
    max-width:900px;
  }
  @media(min-width:768px){
    .layout {
      flex-direction:row;
      align-items:flex-start;
    }
  }

  /* BOARD AREA */
  .board-wrapper {
    flex:1 1 auto;
    display:flex;
    justify-content:center;
  }

  .board {
    width: min(80vw,480px);
    height: min(80vw,480px);
    background:#fff;
    border: 2px solid var(--line);
    border-radius: 16px;
    box-shadow:0 20px 40px rgba(0,0,0,.05);
    position: relative;
    display:grid;
    grid-template-columns: repeat(5,1fr);
    grid-template-rows: repeat(5,1fr);
    gap:4px;
    padding:8px;
    background: radial-gradient(circle at 50% 40%, #ffffff 0%, #e9f6ff 80%);
    font-size:10px;
  }

  /* ê¸°ë³¸ íƒ€ì¼ */
  .tile {
    background:var(--tile-bg);
    border:2px solid var(--tile-border);
    border-radius:10px;
    padding:4px;
    font-size:10px;
    font-weight:600;
    line-height:1.2;
    color:#1d2b3a;
    position:relative;
    display:flex;
    justify-content:center;
    align-items:center;
    text-align:center;
  }

  /* START/GOAL ì¹¸ ê°•ì¡° */
  .start-tile {
    background:var(--special-start);
    border-color:#9fe1ad;
    color:#2f6f33;
  }
  .goal-tile {
    background:var(--special-goal);
    border-color:#ffd36a;
    color:#6a4a00;
  }

  /* ê°€ìš´ë°(ë³´ë“œ ë‚´ë¶€)ëŠ” ë¹„ì›Œë‘ê¸° */
  .empty {
    background:transparent;
    border:none;
    box-shadow:none;
    pointer-events:none;
  }

  /* ì¤‘ì•™ ì•ˆë‚´ í…ìŠ¤íŠ¸(ë¡œê³ ì˜ì—­ ìë¦¬) */
  .center-label{
    position:absolute;
    top:50%;
    left:50%;
    width:70%;
    max-width:240px;
    transform:translate(-50%,-50%);
    text-align:center;
    font-size:12px;
    line-height:1.4;
    background:#ffffffcc;
    border:2px solid var(--line);
    border-radius:12px;
    box-shadow:0 16px 32px rgba(0,0,0,.07);
    padding:12px;
  }
  .center-label-title{
    font-weight:600;
    font-size:14px;
    margin-bottom:4px;
    color:#1d2b3a;
  }
  .center-label-sub{
    font-size:10px;
    color:#4e6b86;
    line-height:1.4;
  }

  /* player tokens */
  .player-token {
    position:absolute;
    width:16px;
    height:16px;
    border-radius:50%;
    border:2px solid #fff;
    box-shadow:0 4px 8px rgba(0,0,0,.2);
  }
  .p1 { background:var(--p1); }
  .p2 { background:var(--p2); }

  /* small index badge (path step) */
  .idx {
    position:absolute;
    top:2px;
    left:4px;
    font-size:8px;
    line-height:1;
    opacity:.4;
    font-weight:600;
  }

  /* SIDE PANEL */
  .panel {
    flex:0 1 260px;
    background:var(--panel-bg);
    border:2px solid var(--line);
    border-radius:16px;
    box-shadow:0 20px 40px rgba(0,0,0,.05);
    padding:16px;
    display:flex;
    flex-direction:column;
    gap:16px;
    font-size:12px;
    line-height:1.4;
  }

  .section-title {
    font-size:12px;
    font-weight:600;
    display:flex;
    align-items:center;
    gap:6px;
    color:#234;
  }

  .row {
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:8px;
  }

  .value-box{
    min-width:36px;
    min-height:36px;
    border-radius:10px;
    border:2px solid var(--line);
    background:#fff;
    font-size:14px;
    font-weight:600;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  #rollBtn{
    background:#1d90ff;
    border:none;
    color:#fff;
    font-size:12px;
    font-weight:600;
    line-height:1;
    padding:10px 12px;
    border-radius:10px;
    box-shadow:0 8px 16px rgba(29,144,255,.3);
    cursor:pointer;
  }
  #rollBtn:active{
    transform:translateY(1px);
    box-shadow:0 4px 8px rgba(29,144,255,.2);
  }

  .players-status{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
  }

  .player-card{
    flex:1 1 110px;
    background:#f9f9fb;
    border:2px solid var(--line);
    border-radius:12px;
    padding:10px;
    line-height:1.4;
    min-width:110px;
  }
  .player-head{
    display:flex;
    align-items:center;
    gap:6px;
    font-weight:600;
    font-size:11px;
  }
  .dot{
    width:10px;
    height:10px;
    border-radius:50%;
    border:2px solid #fff;
    box-shadow:0 2px 4px rgba(0,0,0,.2);
  }
  .dot.p1{ background:var(--p1); }
  .dot.p2{ background:var(--p2); }

  .turn-indicator{
    font-size:11px;
    color:#4e6b86;
  }

  .message-box{
    background:#fffef5;
    border:2px solid #ffe9a9;
    border-radius:12px;
    padding:12px;
    font-size:11px;
    line-height:1.4;
    min-height:70px;
  }
  .message-title{
    font-weight:600;
    margin-bottom:4px;
    color:#6a4a00;
    font-size:11px;
  }
  .message-body{
    color:#4a3a00;
    white-space:pre-line;
  }

  /* MODAL POPUP (í€´ì¦ˆ) */
  .modal-overlay{
    position:fixed;
    left:0;top:0;right:0;bottom:0;
    background:rgba(0,0,0,.4);
    display:none;
    justify-content:center;
    align-items:center;
    padding:16px;
    z-index:999;
  }
  .modal{
    background:#fff;
    border-radius:16px;
    max-width:320px;
    width:100%;
    border:2px solid var(--line);
    box-shadow:0 24px 48px rgba(0,0,0,.25);
    padding:16px;
    font-size:14px;
    line-height:1.4;
  }
  .modal-title{
    font-size:14px;
    font-weight:600;
    margin-bottom:8px;
  }
  .modal-question{
    font-size:13px;
    line-height:1.5;
    margin-bottom:12px;
    white-space:pre-line;
  }
  .choices{
    display:flex;
    flex-direction:column;
    gap:8px;
    margin-bottom:12px;
  }
  .choice-btn{
    border:2px solid var(--line);
    border-radius:10px;
    padding:10px;
    background:#fff;
    font-size:13px;
    text-align:left;
    cursor:pointer;
  }
  .choice-btn.correct{
    border-color:#43c16b;
    background:#e8fff1;
    color:#1c5a2e;
    font-weight:600;
  }
  .choice-btn.wrong{
    border-color:#ff7d7d;
    background:#fff1f1;
    color:#7a1d1d;
    font-weight:600;
  }
  .modal-feedback{
    font-size:12px;
    line-height:1.4;
    min-height:32px;
    color:#4e6b86;
    white-space:pre-line;
    margin-bottom:12px;
  }
  .close-btn{
    width:100%;
    background:#1d90ff;
    color:#fff;
    border:none;
    font-size:13px;
    font-weight:600;
    line-height:1;
    padding:10px;
    border-radius:10px;
    cursor:pointer;
    text-align:center;
  }
  .close-btn:active{
    transform:translateY(1px);
    box-shadow:0 4px 8px rgba(29,144,255,.4);
  }

</style>
</head>
<body>
<h1>ê¹¨ë—ì† ë¶€ë£¨ë§ˆë¸” ğŸ§¼</h1>
<div class="subtitle">
  ì£¼ì‚¬ìœ„ë¥¼ êµ´ë ¤ í•œ ì¹¸ì”© ì´ë™í•´ìš”.<br/>
  ë„ì°©í•œ ì¹¸ì˜ ì†ì”»ê¸° í€´ì¦ˆì— ë‹µí•´ë³¼ê¹Œìš”?
</div>

<div class="layout">
  <!-- BOARD -->
  <div class="board-wrapper">
    <div class="board" id="board">
      <!-- ì¤‘ì•™ ë¼ë²¨(ì›í•˜ë©´ ë¡œê³ /ì´ë¯¸ì§€ë¡œ ë°”ê¿”ë„ ë¨) -->
      <div class="center-label">
        <div class="center-label-title">ì„¸ê³„ ì†ì”»ê¸°ì˜ ë‚ </div>
        <div class="center-label-sub">
          íë¥´ëŠ” ë¬¼ì— ë¹„ëˆ„ë¡œ 30ì´ˆ ğŸ§¼<br/>
          ì†ë°”ë‹¥ â†’ ì†ë“± â†’ ì†ê°€ë½ ì‚¬ì´ â†’ ì†í†± ë°‘ â†’ ì—„ì§€ â†’ ì†ëª©
        </div>
      </div>
    </div>
  </div>

  <!-- SIDE PANEL -->
  <div class="panel">
    <div class="section-title">ğŸ² ì£¼ì‚¬ìœ„ & ì§„í–‰</div>
    <div class="row">
      <div>í˜„ì¬ ì°¨ë¡€:</div>
      <div class="value-box" id="currentPlayerBox">P1</div>
    </div>
    <div class="row">
      <div>ì£¼ì‚¬ìœ„:</div>
      <div class="value-box" id="diceResult">-</div>
      <button id="rollBtn">ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</button>
    </div>

    <div class="players-status">
      <div class="player-card">
        <div class="player-head">
          <div class="dot p1"></div>
          <div>P1 (íŒŒë‘)</div>
        </div>
        <div class="turn-indicator">ìœ„ì¹˜: <span id="p1PosText">0</span> ì¹¸</div>
      </div>

      <div class="player-card">
        <div class="player-head">
          <div class="dot p2"></div>
          <div>P2 (í•‘í¬)</div>
        </div>
        <div class="turn-indicator">ìœ„ì¹˜: <span id="p2PosText">0</span> ì¹¸</div>
      </div>
    </div>

    <div class="section-title">ğŸ“¢ í˜„ì¬ ì¹¸</div>
    <div class="message-box">
      <div class="message-title" id="messageTitle">ê²Œì„ ì‹œì‘</div>
      <div class="message-body" id="messageBody">
        START ì¹¸ì…ë‹ˆë‹¤.
        ì£¼ì‚¬ìœ„ë¥¼ ëˆŒëŸ¬ ì´ë™í•´ìš”!
      </div>
    </div>
  </div>
</div>

<!-- MODAL: í€´ì¦ˆ íŒì—… -->
<div class="modal-overlay" id="quizModal">
  <div class="modal">
    <div class="modal-title" id="quizTitle">í€´ì¦ˆ ì œëª©</div>
    <div class="modal-question" id="quizQuestion">ì§ˆë¬¸ ë‚´ìš©</div>
    <div class="choices" id="choicesContainer"></div>
    <div class="modal-feedback" id="quizFeedback"></div>
    <button class="close-btn" id="closeQuizBtn">ë‹«ê¸°</button>
  </div>
</div>

<script>
/* =====================
   ê²½ë¡œ êµ¬ì„±
   =====================

ìš°ë¦¬ëŠ” 5x5 ê·¸ë¦¬ë“œ(0~24 index)ë¥¼ ì“¸ ê±°ê³ ,
í…Œë‘ë¦¬ë§Œ ì‹¤ì œ ì¹¸ìœ¼ë¡œ ì‚¬ìš©í•´ í•œ ë°”í€´ ë„ëŠ” êµ¬ì¡°ë¡œ ê°ˆê²Œ.

gridIndex = row*5+col

í…Œë‘ë¦¬ ìˆœì„œ(ì‹œê³„ë°©í–¥):
(4,4) START -> ... -> ë‹¤ì‹œ (4,4) GOAL ëŠë‚Œ.
ì¦‰ STARTì™€ GOALì€ ê°™ì€ ì¹¸ì¸ë°
'í•œ ë°”í€´ ì™„ë£Œí–ˆëŠ”ì§€'ë¡œ GOAL íŒì •.

ê²½ë¡œ:
ì•„ë˜ì¤„ ì˜¤ë¥¸â†’ì™¼, ì™¼ìª½ ìœ„ë¡œ, ìœ„ìª½ ì™¼â†’ì˜¤, ì˜¤ë¥¸ìª½ ì•„ë˜ë¡œ ë‹¤ì‹œ ì¶œë°œì§€ ê·¼ì²˜

ê²½ë¡œ ì¸ë±ìŠ¤:
(4,4)=24 START
(4,3)=23
(4,2)=22
(4,1)=21
(4,0)=20
(3,0)=15
(2,0)=10
(1,0)=5
(0,0)=0
(0,1)=1
(0,2)=2
(0,3)=3
(0,4)=4
(1,4)=9
(2,4)=14
(3,4)=19
(4,4)=24 ë‹¤ì‹œ ë„ì°© â†’ GOAL

=> ì´ 17ìŠ¤í…ì´ì§€ë§Œ ìš°ë¦¬ëŠ” "ì¤‘ë³µ ì—†ì´" ëŒê³  ì‹¶ìœ¼ë‹ˆê¹Œ
(4,4) ì¤‘ë³µì„ ë¹¼ê³  ê²½ë¡œë¥¼ linearí•˜ê²Œ ë§Œë“¤ë©´:
[24,23,22,21,20,15,10,5,0,1,2,3,4,9,14,19] 16ì¹¸ + ë§ˆì§€ë§‰ì— ë‹¤ì‹œ 24ë¡œ ëŒì•„ì˜¤ë©´ ê³¨ì¸.

ì¦‰: pathIndex 0~15 ê¹Œì§€ ì§„í–‰ í›„
ë‹¤ìŒ ì´ë™ìœ¼ë¡œ ë‹¤ì‹œ 24ì— ì˜¤ë©´ GOAL.
*/

const pathOrder = [
  24,23,22,21,20,15,10,5,0,1,2,3,4,9,14,19
];
// pathOrder[0] = 24(START tile gridIndex)
// pathOrder[last] = 19, ê·¸ë¦¬ê³  ë‹¤ìŒ ì¹¸ì€ ë‹¤ì‹œ 24ë¡œ ê°€ë©´ GOAL

// ì¹¸ íƒ€ì´í‹€(ë³´ë“œì— ì í ì§§ì€ ì´ë¦„) + í€´ì¦ˆ ë°ì´í„°
// ê° path ìœ„ì¹˜ë³„ë¡œ í•˜ë‚˜ì”©
const tilesData = [
  {
    label:"START",
    start:true,
    quiz:{
      title:"ì‹œì‘!",
      question:"ê¹¨ë—í•œ ì†ìœ¼ë¡œ ê±´ê°• ì§€í‚¤ê¸° ëª¨í—˜ì„ ì‹œì‘í•´ìš”!",
      type:"info",
      choices:[],
      answerIndex:null,
      feedback:"ì£¼ì‚¬ìœ„ë¥¼ êµ´ë ¤ ì•ìœ¼ë¡œ ê°€ìš”!"
    }
  },
  {
    label:"ì–¸ì œ ì”»ì§€?",
    quiz:{
      title:"ì–¸ì œ ì†ì„ ì”»ì–´ì•¼ í• ê¹Œìš”?",
      question:"ë‹¤ìŒ ì¤‘ ì†ì„ ê¼­ ì”»ì–´ì•¼ í•˜ëŠ” ë•ŒëŠ”?\n1) ë°¥ ë¨¹ê¸° ì „\n2) ì¥ë‚œê° ë³´ê¸° ì „",
      type:"mcq",
      choices:["ë°¥ ë¨¹ê¸° ì „","ì¥ë‚œê° ë³´ê¸° ì „"],
      answerIndex:0,
      feedback:"ì‹ì‚¬í•˜ê±°ë‚˜ ê°„ì‹ ë¨¹ê¸° ì „ì—” ì†ì„ ê¹¨ë—í•˜ê²Œ ì”»ì–´ìš” ğŸ½"
    }
  },
  {
    label:"O / X",
    quiz:{
      title:"O / X ë¬¸ì œ",
      question:"í™”ì¥ì‹¤ ë‹¤ë…€ì˜¨ ë’¤ì—ëŠ” ì†ì„ ì”»ì§€ ì•Šì•„ë„ ëœë‹¤.",
      type:"ox",
      choices:["O (ë§ì•„ìš”)","X (ì•„ë‹ˆì—ìš”)"],
      answerIndex:1,
      feedback:"í™”ì¥ì‹¤ ë‹¤ë…€ì˜¨ í›„ì—ëŠ” ê¼­ ë¹„ëˆ„ë¡œ 30ì´ˆ ì†ì”»ê¸°! ğŸš½ğŸ§¼"
    }
  },
  {
    label:"ë¹„ëˆ„ ê¼­?",
    quiz:{
      title:"ë¹„ëˆ„ê°€ ì™œ í•„ìš”í• ê¹Œ?",
      question:"ì†ì— ë¬»ì€ ì„¸ê· ì„ ì˜ ì—†ì• ì£¼ëŠ” ê²ƒì€ ë¬´ì—‡ì¼ê¹Œìš”?\n1) ë¹„ëˆ„ì™€ ë¬¼\n2) ë°”ëŒ ì¬ê¸°",
      type:"mcq",
      choices:["ë¹„ëˆ„ì™€ ë¬¼","ë°”ëŒ ì¬ê¸°"],
      answerIndex:0,
      feedback:"íë¥´ëŠ” ë¬¼ + ë¹„ëˆ„ë¡œ ë¬¸ì§ˆë¬¸ì§ˆ í•´ì•¼ ì„¸ê· ì´ ì˜ ë–¨ì–´ì ¸ìš” ğŸ§¼ğŸ’¦"
    }
  },
  {
    label:"ê¸°ì¹¨í–ˆì–´",
    quiz:{
      title:"ê¸°ì¹¨ í›„ì—ëŠ”?",
      question:"ë‚´ê°€ ì†ìœ¼ë¡œ ì…ì„ ê°€ë¦¬ê³  ê¸°ì¹¨í–ˆì–´ìš”.\nê·¸ ë‹¤ìŒ í•´ì•¼ í•  ì¼ì€?",
      type:"mcq",
      choices:["ì†ì”»ê¸°","ì•„ë¬´ ê²ƒë„ ì•ˆ í•˜ê¸°"],
      answerIndex:0,
      feedback:"ê¸°ì¹¨Â·ì½§ë¬¼ ë’¤ì—” ì†ì”»ê¸°ë¡œ ê°ì—¼ë³‘ì„ ë§‰ì•„ìš” ğŸ¤§â¡ğŸ§¼"
    }
  },
  {
    label:"ì½” ë§Œì¡Œì–´",
    quiz:{
      title:"ì½§ë¬¼ ë‹¦ì€ ë’¤",
      question:"ì½§ë¬¼ì„ ë‹¦ì•˜ì„ ë•?\n1) ê·¸ëƒ¥ ë†€ì´ ê³„ì†í•˜ê¸°\n2) ì†ì„ ì”»ê¸°",
      type:"mcq",
      choices:["ê·¸ëƒ¥ ë†€ì´ ê³„ì†í•˜ê¸°","ì†ì„ ì”»ê¸°"],
      answerIndex:1,
      feedback:"ì½§ë¬¼ ë‹¦ì€ ë’¤ì—” ì†ì„ ê¹¨ë—í•˜ê²Œ ì”»ì–´ì•¼ í•´ìš” ğŸ‘ƒğŸ§¼"
    }
  },
  {
    label:"ë°”ê¹¥ë†€ì´ í›„",
    quiz:{
      title:"ë†€ì´í„° ë‹¤ë…€ì˜¨ ë’¤",
      question:"ëª¨ë˜ë†€ì´, ë¯¸ë„ëŸ¼í‹€ ë†€ì´ í›„ì—ëŠ”?\nO) ì†ì”»ê¸°\nX) ê·¸ëƒ¥ ê°„ì‹ ë¨¹ê¸°",
      type:"ox",
      choices:["O ì†ì”»ê¸°","X ê·¸ëƒ¥ ë¨¹ê¸°"],
      answerIndex:0,
      feedback:"ë°”ê¹¥ë†€ì´ í›„ì—” ì†ì„ ì”»ê³  ëˆˆÂ·ì…ì„ ë§Œì§€ì§€ ì•Šì•„ìš” ğŸ›"
    }
  },
  {
    label:"ë™ë¬¼ ë§Œì¡Œì–´",
    quiz:{
      title:"ê°•ì•„ì§€ ì“°ë‹´ì“°ë‹´ğŸ¶",
      question:"ê°•ì•„ì§€/ê³ ì–‘ì´ ë§Œì§„ ë’¤, ë°”ë¡œ ì†ê°€ë½ ë¹¨ì•„ë„ ë ê¹Œ?",
      type:"mcq",
      choices:["ì‘ ê´œì°®ì•„","ì•„ë‹ˆ, ì†ì”»ê³  ë¨¹ì–´ì•¼ í•´"],
      answerIndex:1,
      feedback:"ë™ë¬¼ ë§Œì§„ ë’¤ì—” ê¼­ ì†ì„ ì”»ê³  ìŒì‹ ë§Œì§€ê¸° ğŸ¶ğŸ§¼"
    }
  },
  {
    label:"ì†ê°€ë½ ì‚¬ì´",
    quiz:{
      title:"ê¹¨ë—í•˜ê²Œ ì”»ëŠ” ë°©ë²•",
      question:"ì†ë°”ë‹¥ë§Œ ì‚´ì§ ì”»ìœ¼ë©´ ë ê¹Œ?\nì•„ë‹ˆë©´ ì†ê°€ë½ ì‚¬ì´ê¹Œì§€ ê¾¹ê¾¹ ì”»ì–´ì•¼ í• ê¹Œ?",
      type:"mcq",
      choices:["ì†ë°”ë‹¥ë§Œ","ì†ê°€ë½ ì‚¬ì´ê¹Œì§€"],
      answerIndex:1,
      feedback:"ì†ê°€ë½ ì‚¬ì´, ì†í†± ë°‘ê¹Œì§€ â€˜ë¬¸ì§ˆë¬¸ì§ˆâ€™ í•´ì•¼ ê¹¨ë—í•´ìš” âœ¨"
    }
  },
  {
    label:"30ì´ˆ ê¸°ë‹¤ë ¤",
    quiz:{
      title:"ì–¼ë§ˆë‚˜ ì”»ì„ê¹Œ?",
      question:"ì†ì”»ê¸°ëŠ” ëª‡ ì´ˆ ë™ì•ˆ í•˜ëŠ” ê²Œ ì¢‹ì„ê¹Œìš”?\n1) 3ì´ˆ\n2) 30ì´ˆ",
      type:"mcq",
      choices:["3ì´ˆ","30ì´ˆ"],
      answerIndex:1,
      feedback:"ë¹„ëˆ„ë¡œ 30ì´ˆ ë™ì•ˆ ì²œì²œíˆ ë¬¸ì§ˆëŸ¬ìš”. íƒ€ì´ë¨¸ â€˜ë ë§â€™ê¹Œì§€! â±"
    }
  },
  {
    label:"ë¹„ëˆ„ ê±°í’ˆ",
    quiz:{
      title:"ê±°í’ˆì˜ í˜",
      question:"ë¹„ëˆ„ ê±°í’ˆì€ ì„¸ê· ì„ ë–¼ì–´ë‚´ëŠ” ë° ë„ì›€ì„ ì¤„ê¹Œìš”?",
      type:"ox",
      choices:["O ë„ì›€ì´ ë¼ìš”","X ì „í˜€ í•„ìš”ì—†ì–´ìš”"],
      answerIndex:0,
      feedback:"ê±°í’ˆì´ ì„¸ê· ì„ ë–¼ì–´ë‚´ê³  ë¬¼ì´ ì”»ì–´ë‚´ìš” ğŸ«§"
    }
  },
  {
    label:"ì†ëª©ê¹Œì§€",
    quiz:{
      title:"ì† ì–´ë””ê¹Œì§€ ì”»ì–´ìš”?",
      question:"ì†ê°€ë½ë§Œ ì”»ìœ¼ë©´ ë ê¹Œìš”?\nì•„ë‹ˆë©´ ì†ëª©ê¹Œì§€ ì”»ì–´ì•¼ í• ê¹Œìš”?",
      type:"mcq",
      choices:["ì†ê°€ë½ë§Œ","ì†ëª©ê¹Œì§€ ì‹¹ì‹¹"],
      answerIndex:1,
      feedback:"ì†ëª©ê¹Œì§€ ëŒë ¤ ì”»ì–´ì£¼ë©´ ë” ê¹¨ë—í•´ìš” ğŸ’ªğŸ§¼"
    }
  },
  {
    label:"ì¹œêµ¬ë‘ ê°™ì´",
    quiz:{
      title:"ì¹œêµ¬ì™€ ì•½ì†",
      question:"ì¹œêµ¬ì—ê²Œ â€˜ë°¥ ë¨¹ê¸° ì „ì—ëŠ” ì† ì”»ì!â€™ ë¼ê³  ë§í•´ì£¼ëŠ” ê±´ ì¢‹ì€ ê±¸ê¹Œ?",
      type:"ox",
      choices:["O ì¢‹ì€ í–‰ë™","X ì“¸ë°ì—†ì–´"],
      answerIndex:0,
      feedback:"í•¨ê»˜ ì•Œë ¤ì£¼ë©´ ì¹œêµ¬ë„ ê±´ê°•í•´ì ¸ìš” ğŸ‘«"
    }
  },
  {
    label:"ëˆˆ ë¹„ë¹„ì§€ ì•Šê¸°",
    quiz:{
      title:"ë”ëŸ¬ìš´ ì†ìœ¼ë¡œ ëˆˆ ë§Œì§€ë©´?",
      question:"ë†€ì´í„°ì—ì„œ ë†€ê³  ê·¸ëŒ€ë¡œ ëˆˆì„ ë¹„ë¹„ë©´ ì–´ë–»ê²Œ ë ê¹Œ?",
      type:"mcq",
      choices:["ì„¸ê· ì´ ë“¤ì–´ê°ˆ ìˆ˜ ìˆì–´ìš”","ì•„ë¬´ ì¼ë„ ì•ˆ ìƒê²¨ìš”"],
      answerIndex:0,
      feedback:"ë”ëŸ¬ìš´ ì†ì´ ëˆˆÂ·ì½”Â·ì…ì— ë‹¿ìœ¼ë©´ ì„¸ê· ì´ ëª¸ì†ìœ¼ë¡œ ë“¤ì–´ê°ˆ ìˆ˜ ìˆì–´ìš” ğŸ‘€"
    }
  },
  {
    label:"ìˆ˜ê±´ìœ¼ë¡œ ê¾¹",
    quiz:{
      title:"ì† ë‹¦ì„ ë•Œ",
      question:"ì†ì„ ë‹¤ ì”»ì€ ë‹¤ìŒì—ëŠ”?\n1) ë°”ì§€ì— ìŠ¥ìŠ¥\n2) ê°œì¸ìˆ˜ê±´/ì¼íšŒìš© íƒ€ì›”ë¡œ ê¾¹ê¾¹",
      type:"mcq",
      choices:["ë°”ì§€ì— ìŠ¥ìŠ¥","ê°œì¸ìˆ˜ê±´/ì¼íšŒìš© íƒ€ì›”"],
      answerIndex:1,
      feedback:"ê¹¨ë—í•œ ìˆ˜ê±´ìœ¼ë¡œ ê¾¹ê¾¹ ë‹¦ì•„ìš” ğŸ§»"
    }
  },
  {
    label:"ê±°ì˜ ë‹¤ ì™”ì–´",
    quiz:{
      title:"GOAL ì§ì „!",
      question:"ì¡°ê¸ˆë§Œ ë” ê°€ë©´ ê¹¨ë—ì† ì±”í”¼ì–¸!\nì¤€ë¹„ëë‚˜ìš”?",
      type:"info",
      choices:[],
      answerIndex:null,
      feedback:"ë§ˆì§€ë§‰ í•œ ì¹¸ë§Œ ë” ê°€ìš”!"
    }
  }
];

// ì†ì”»ê¸° 6ë‹¨ê³„ ì•ˆë‚´ (GOAL ë„ì°© ì‹œ)
const finalPopup = {
  title:"ì¶•í•˜í•´ìš”! ê¹¨ë—ì† ì±”í”¼ì–¸ ğŸ‰",
  question:
    "ì†ì”»ê¸° 6ë‹¨ê³„ ê¸°ì–µí•´ë³¼ê¹Œìš”?\n\n" +
    "1. ì†ë°”ë‹¥ ë¬¸ì§ˆë¬¸ì§ˆ\n" +
    "2. ì†ë“±ë„ ì“±ì“±\n" +
    "3. ì†ê°€ë½ ì‚¬ì´ ì‚¬ì´ ê¼¼ê¼¼í•˜ê²Œ\n" +
    "4. ì†í†± ë°‘ ê¾¹ê¾¹ ë¬¸ì§€ë¥´ê¸°\n" +
    "5. ì—„ì§€ì†ê°€ë½ ë¹™ê¸€ë¹™ê¸€\n" +
    "6. ì†ëª©ê¹Œì§€ ì‹¹ì‹¹\n\n" +
    "íë¥´ëŠ” ë¬¼ì— ë¹„ëˆ„ë¡œ 30ì´ˆ!",
  type:"info",
  choices:[],
  answerIndex:null,
  feedback:"ë„ˆë‘ í•¨ê»˜ë¼ì„œ ë” ì•ˆì „í•´ì¡Œì–´ ğŸ§¼ğŸ’–"
};

/* =====================
   ë³´ë“œ DOM ìƒì„±
   =====================*/

const boardEl = document.getElementById("board");

// 25ì¹¸ ë§Œë“¤ê¸° (5x5). ì „ë¶€ ê¸°ë³¸ì ìœ¼ë¡œ emptyë¡œ ê¹”ê³ ,
// pathOrderì— í•´ë‹¹í•˜ëŠ” ì¹¸ë§Œ ì‹¤ì œ íƒ€ì¼ë¡œ ë°”ê¿ˆ.
for(let cell=0; cell<25; cell++){
  const d=document.createElement("div");
  d.classList.add("tile","empty");
  d.dataset.gridIndex = cell; // 0~24
  boardEl.appendChild(d);
}

// pathOrderì— ë”°ë¼ í‘œì‹œ
for(let step=0; step<pathOrder.length; step++){
  const gridIdx = pathOrder[step]; // 24,23,22...
  const tileEl = boardEl.querySelector(`[data-grid-index="${gridIdx}"]`);
  tileEl.classList.remove("empty");

  // START ì¹¸ (path step 0)
  if(step===0){
    tileEl.classList.add("start-tile");
  }
  // ë§ˆì§€ë§‰ path step (pathOrder[pathOrder.length-1])ì€ GOALë¡œ ê°€ê¸° ì§ì „ ì¹¸
  if(step===pathOrder.length-1){
    tileEl.classList.add("goal-tile");
  }

  // idx badge + label
  const idxDiv=document.createElement("div");
  idxDiv.classList.add("idx");
  idxDiv.textContent = step;
  tileEl.appendChild(idxDiv);

  const labelDiv=document.createElement("div");
  labelDiv.style.fontSize="10px";
  labelDiv.style.fontWeight="600";
  labelDiv.style.textAlign="center";
  labelDiv.textContent = tilesData[step].label;
  tileEl.appendChild(labelDiv);
}

/* =====================
   ê²Œì„ ìƒíƒœ
   =====================*/
let currentPlayer = 1; // 1 or 2
let pos = {1:0, 2:0};  // path index ìœ„ì¹˜ (0~ë§ˆì§€ë§‰)
let finished = {1:false, 2:false};
let gameOver = false;

// UI refs
const diceBox = document.getElementById("diceResult");
const rollBtn = document.getElementById("rollBtn");
const messageTitle = document.getElementById("messageTitle");
const messageBody = document.getElementById("messageBody");
const p1PosText = document.getElementById("p1PosText");
const p2PosText = document.getElementById("p2PosText");
const currentPlayerBox = document.getElementById("currentPlayerBox");

// modal refs
const quizModal = document.getElementById("quizModal");
const quizTitle = document.getElementById("quizTitle");
const quizQuestion = document.getElementById("quizQuestion");
const quizFeedback = document.getElementById("quizFeedback");
const choicesContainer = document.getElementById("choicesContainer");
const closeQuizBtn = document.getElementById("closeQuizBtn");

/* í”Œë ˆì´ì–´ ë§ ê·¸ë¦¬ê¸° */
function renderPlayers(){
  // ì´ì „ í† í° ì‚­ì œ
  document.querySelectorAll(".player-token").forEach(n=>n.remove());

  [1,2].forEach(p=>{
    const pathIdx = pos[p];
    const gridIdx = pathOrder[pathIdx];
    const tileEl = boardEl.querySelector(`[data-grid-index="${gridIdx}"]`);
    if(!tileEl) return;
    const token=document.createElement("div");
    token.classList.add("player-token", p===1?"p1":"p2");

    // ë‘ ëª… ê²¹ì¹˜ë©´ ì¢Œìš°ë¡œ ì‚´ì§ ë‚˜ëˆ 
    if(p===1){
      token.style.bottom="4px";
      token.style.left="4px";
    } else {
      token.style.bottom="4px";
      token.style.right="4px";
    }
    tileEl.appendChild(token);
  });

  p1PosText.textContent = pos[1];
  p2PosText.textContent = pos[2];
  currentPlayerBox.textContent = currentPlayer===1?"P1":"P2";
}

/* ì¹¸ ì •ë³´ í‘œì‹œ + í€´ì¦ˆ ëª¨ë‹¬ ë„ìš°ê¸° */
function arriveTile(player){
  const step = pos[player];
  const tileInfo = tilesData[step];

  // ì‚¬ì´ë“œ íŒ¨ë„ í˜„ì¬ì¹¸ í‘œì‹œ
  messageTitle.textContent = tileInfo.label;
  messageBody.textContent = tileInfo.quiz.feedback || tileInfo.quiz.question || "";

  // GOAL ì²´í¬:
  // GOALì€ "í•œ ë°”í€´ ëŒì•„ì„œ ë‹¤ì‹œ STARTì§€ì (=gridIdx 24)" ì˜¤ë©´.
  // ìš°ë¦¬ì˜ path ë§ˆì§€ë§‰ indexëŠ” pathOrder.length-1.
  // ê·¸ ë‹¤ìŒì— ë‹¤ì‹œ START(24)ë¡œ ì˜¤ë©´ finish(true)
  // êµ¬í˜„: ë§Œì•½ í˜„ì¬ê°€ pathOrder.length-1 ì´ê³  ì£¼ì‚¬ìœ„ê°€ ì•ìœ¼ë¡œ ê°€ì„œ
  // ë‹¤ì‹œ START(0) ì´ìƒ ë„˜ì–´ê°”ë‹¤ë©´ finishë¡œ ì²˜ë¦¬í•´ì•¼ í•¨.
  // ê°„ë‹¨í™”: í”Œë ˆì´ì–´ê°€ ë§ˆì§€ë§‰ ì¹¸(path ë§ˆì§€ë§‰ index)ì„ ì§€ë‚˜ ì•ìœ¼ë¡œ ë” ê°€ë ¤ê³  í•  ë•Œ finish.
  // => move ë‹¨ê³„ì—ì„œ ì²˜ë¦¬.

  // í€´ì¦ˆ ëª¨ë‹¬ ë„ìš°ê¸°
  openQuizModal(tileInfo.quiz);
}

/* í€´ì¦ˆ ëª¨ë‹¬ êµ¬ì„± */
function openQuizModal(quiz){
  quizModal.style.display="flex";
  quizTitle.textContent = quiz.title;
  quizQuestion.textContent = quiz.question;
  quizFeedback.textContent = "";
  choicesContainer.innerHTML = "";

  // type infoì´ë©´ ë‹«ê¸°ë§Œ
  if(quiz.type==="info"){
    closeQuizBtn.textContent="í™•ì¸";
    return;
  }

  closeQuizBtn.textContent="ë‹«ê¸°";

  quiz.choices.forEach((choiceText, idx)=>{
    const btn=document.createElement("button");
    btn.classList.add("choice-btn");
    btn.textContent = choiceText;
    btn.addEventListener("click",()=>{
      const correct = (idx===quiz.answerIndex);
      if(correct){
        btn.classList.add("correct");
        quizFeedback.textContent = quiz.feedback || "ì •ë‹µ!";
      }else{
        btn.classList.add("wrong");
        quizFeedback.textContent = "ë‹¤ì‹œ í•œë²ˆ ìƒê°í•´ë³¼ê¹Œ?\n" + (quiz.feedback||"");
      }
    });
    choicesContainer.appendChild(btn);
  });
}

/* ìµœì¢…(ì†ì”»ê¸° 6ë‹¨ê³„) ëª¨ë‹¬ */
function openFinalModal(){
  quizModal.style.display="flex";
  quizTitle.textContent = finalPopup.title;
  quizQuestion.textContent = finalPopup.question;
  quizFeedback.textContent = finalPopup.feedback;
  choicesContainer.innerHTML = "";
  closeQuizBtn.textContent="ì™„ë£Œ";
}

/* ëª¨ë‹¬ ë‹«ê¸° */
closeQuizBtn.addEventListener("click",()=>{
  quizModal.style.display="none";
});

/* ì´ë™ ì²˜ë¦¬ */
function movePlayer(steps){
  if(gameOver) return;

  const p=currentPlayer;
  let newPos = pos[p] + steps;

  // ì•„ì§ ì•ˆ ëë‚œ í”Œë ˆì´ì–´ë§Œ ì´ë™
  if(finished[p]){
    // ì´ë¯¸ ê³¨ì¸í–ˆìœ¼ë©´ ê·¸ëƒ¥ ì°¨ë¡€ ë„˜ê¹€
  } else {
    // ë§Œì•½ path ë(ë§ˆì§€ë§‰ ì¸ë±ìŠ¤ 15)ì„ ë„˜ìœ¼ë©´ -> GOAL ë„ì°©ìœ¼ë¡œ ì²˜ë¦¬
    if(newPos > pathOrder.length-1){
      newPos = 0; // ë‹¤ì‹œ START ìœ„ì¹˜ë¡œ ëŒì•„ì˜¨ ê±°ë¼ê³  ê°„ì£¼
      finished[p]=true;
      pos[p]=newPos;
      renderPlayers();
      openFinalModal();
    } else {
      // ì •ìƒ ì´ë™
      pos[p]=newPos;
      renderPlayers();
      arriveTile(p);
    }
  }

  // ëª¨ë‘ ëë‚¬ëŠ”ì§€ ì²´í¬
  if(finished[1] && finished[2]){
    gameOver=true;
  }

  // í„´ êµì²´
  currentPlayer = (currentPlayer===1)?2:1;
  renderPlayers();
}

/* ì£¼ì‚¬ìœ„ ë²„íŠ¼ */
const diceEl = document.getElementById("diceResult");
rollBtn.addEventListener("click",()=>{
  if(gameOver) return;
  const roll = Math.floor(Math.random()*6)+1;
  diceEl.textContent = roll;
  movePlayer(roll);
});

/* ì´ˆê¸° ë Œë” */
renderPlayers();
arriveTile(1); // ì²˜ìŒ ì•ˆë‚´(START)
</script>
</body>
</html>
